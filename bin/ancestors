#!/usr/bin/env python2.7

from os.path import exists
from sys import argv, exit as sys_exit

from Bio import SeqIO

from idepi import Ancestors, is_HXB2


def main(argv=argv):
    name = argv[0]
    args = argv[1:]
    if len(args) != 1 or not exists(args[0]):
        print >> stderr, 'usage: ancestors ALIGNMENT'
        sys_exit(-1)

    with open(args[0]) as fh:
        seqrecords = [r for r in SeqIO.parse(fh, 'fasta') if not is_HXB2(r.id)]

    tree, ancestors = Ancestors()(seqrecords)

    print tree, ancestors

    return 0

if __name__ == '__main__':
    sys_exit(main())
